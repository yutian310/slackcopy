id: CVE-2022-22916

info:
  name: O2OA后台远程命令执行
  author: qwtd
  severity: high
  description: |
    O2OA是一个基于J2EE分布式架构，集成移动办公、智能办公，支持私有化部署，自适应负载能力的，能够很大程度上节约企业软件开发成本的基于AGPL协议开放源代码的企业信息化系统需求定制开发平台解决方案。 通过 /x_program_center/jaxrs/invoke 发现 O2OA v6.4.7 包含一个远程代码执行 (RCE) 漏洞.
  reference:
    - https://github.com/wy876/POC/blob/main/O2OA/O2OA%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(CVE-2022-22916).md
    - https://www.linuxlz.com/wap/aqld/3076.html
  tags: 兰德网络-O2OA

http:
  - method: POST
    path:
      - "{{BaseURL}}/x_program_center/jaxrs/invoke?v=6.3"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'com.x.program.center.jaxrs.invoke.ExceptionEmptyName'

      - type: status
        status:
          - 500